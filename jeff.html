<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>You're a Sorting Hat, Harry!</title>
    <script src="libs/phaser-2.3.0.js"></script>
    <script src="libs/namey-api.js"></script>
    <script src="generators/text-gen.js"></script>
    <script src="data/event-data.js"></script>
    <script src="generators/event-gen.js"></script>
    <script src="generators/student-gen.js"></script>
    <script src="generators/house-gen.js"></script>
                                    
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
  </head>
<body>
    <script type="text/javascript">
    var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });
    
    var students = [];
    var houses = [];
    var events = [];
    var NUMSTUDENTS = 50; //Make twice as many!
    var NUMHOUSES = 4;
    var isLoaded = false;
        
    function preload() {
        
        var studentFactory = new StudentFactory();
        //for (var i = 0; i < NUMSTUDENTS; i++) {
            students.push(studentFactory.createStudent('male'));
            students.push(studentFactory.createStudent('female'));
        //}
        var houseFactory = new HouseFactory();
        for (var i = 0; i < NUMHOUSES; i++) {
            houses.push(houseFactory.createHouse(null));
        }
        
                
        //Grab an event
        var eventFactory = new EventFactory();
        events.push(eventFactory.createEvent(null));
        
    }
    
    function create() {
        
    }
        
    function update() {
        len = students.length;
        if (students[len-1].name != "ERRORNAME" && isLoaded === false) {
            for (var i = 0; i < houses.length; i++) {
                houses[i].returnStats();
            }
            //Assign everyone a house
            for (var i = 0; i < students.length; i++) {
                var houseNum = Math.floor(Math.random() * houses.length);
                students[i].house = houses[houseNum];
                houses[houseNum].students.push(students[i]);
            }
            for (var i = 0; i < len; i++) {
                students[i].returnTextStats();
            }
            events[0].returnEvent();
            isLoaded = true;
        }
        

        
            
        
        
    }
    
    </script>
  </body>
</html>

